import * as expect from 'expect'
import * as utils from '../src/utils/utils'
import { BigNumber } from '../src/utils/BigNumber'

let tests = [
  { value: 1, expected: '0x1' },
  { value: '1', expected: '0x1' },
  { value: '0x1', expected: '0x1' },
  { value: '15', expected: '0xf' },
  { value: '0xf', expected: '0xf' },
  { value: -1, expected: '-0x1' },
  { value: '-1', expected: '-0x1' },
  { value: '-0x1', expected: '-0x1' },
  { value: '-15', expected: '-0xf' },
  { value: '-0xf', expected: '-0xf' },
  { value: '0x657468657265756d', expected: '0x657468657265756d' },
  {
    value: '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd',
    expected: '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd'
  },
  {
    value: '-0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff',
    expected: '-0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'
  },
  {
    value: '-0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd',
    expected: '-0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd'
  },
  { value: new Uint8Array([0, 1, 2, 3, 4, 0, 0]), expected: '0x00010203040000' },
  { value: 0, expected: '0x0' },
  { value: '0', expected: '0x0' },
  { value: '0x0', expected: '0x0' },
  { value: -0, expected: '0x0' },
  { value: '-0', expected: '0x0' },
  { value: '-0x0', expected: '0x0' },
  { value: '{"test": "test"}', expected: '7b2274657374223a202274657374227d' },
  { value: 'myString', expected: '6d79537472696e67' },
  { value: '내가 제일 잘 나가', expected: 'eb82b4eab08020eca09cec9dbc20ec9e9820eb8298eab080' },
  { value: new BigNumber(15), expected: '0xf' },
  { value: true, expected: '0x1' },
  { value: false, expected: '0x0' },
  {
    value:
      '\u0003\u0000\u0000\u00005èÆÕL]\u0012|Î¾\u001a7«\u00052\u0011(ÐY\n<\u0010\u0000\u0000\u0000\u0000\u0000\u0000e!ßd/ñõì\f:z¦Î¦±ç·÷Í¢Ëß\u00076*\bñùC1ÉUÀé2\u001aÓB',
    expected:
      '0300000035c3a8c386c3954c5d127cc29dc38ec2bec29e1a37c2abc29b05321128c390c297590a3c100000000000006521c39f642fc3b1c3b5c3ac0c3a7ac2a6c38ec2a6c2b1c3a7c2b7c3b7c38dc2a2c38bc39f07362ac28508c28ec297c3b1c29ec3b94331c38955c380c3a9321ac393c28642c28c'
  }
]

describe('lib/utils/utils', function () {
  describe('toHex', function () {
    tests.forEach(function (test) {
      it('should turn ' + test.value + ' to ' + test.expected, function () {
        expect(utils.toHex(test.value as any)).toEqual(test.expected)
      })
    })
    it('should throw in arrays', function () {
      expect(() => utils.toHex([1, 2, 3, { test: 'data' }] as any)).toThrow()
    })
    it('should throw in objects', function () {
      expect(() => utils.toHex({ test: 'data' } as any)).toThrow()
    })
  })
})
